{
  "version": 3,
  "sources": ["../src/mod.ts", "../src/moduleVersionChecker.ts", "../src/moduleVersionResolver.ts", "../src/moduleTypes.ts", "../src/util.ts", "../src/files.ts", "../src/moduleNameParser.ts", "../src/fileResolver.ts", "../src/moduleVersionReplacer.ts", "../src/fileVersionReplacer.ts", "../app.json", "../src/moduleVersionUpdater.ts"],
  "sourcesContent": ["import * as fs from 'fs';\nimport * as posix from 'posix';\nimport * as cliffy from 'cliffy';\nimport { Module } from './moduleTypes.ts';\nimport checkModuleVersion, {\n  ModuleVersionCheckResult,\n} from './moduleVersionChecker.ts';\nimport { configurations as fileConfigs, FileConfig } from './files.ts';\nimport appInfo from '../app.json' assert { type: 'json' };\nimport { buildTableString } from './util.ts';\nimport updateVersion from './moduleVersionUpdater.ts';\n\nconst enumerateFiles = async function* (basePath: string, files: string[]) {\n  for (const filename of files) {\n    for await (const file of fs.expandGlob(posix.resolve(basePath, filename))) {\n      if (file.isFile) {\n        yield [file.path, filename];\n      }\n    }\n  }\n};\n\nconst printVersionCheckResult = function (results: ModuleVersionCheckResult[]) {\n  // type guards for version check result\n  const isFound = (\n    item: ModuleVersionCheckResult,\n  ): item is ModuleVersionCheckResult & { found: true } => item.found;\n  const isNotFound = (\n    item: ModuleVersionCheckResult,\n  ): item is ModuleVersionCheckResult & { found: false } => !item.found;\n\n  const outdatedModules = results.filter(isFound).filter((result) =>\n    result.outdated\n  );\n  const notFoundModules = results.filter(isNotFound);\n  const notFixedModules = results.filter((result) => !result.fixed);\n\n  console.log(\n    `\\x1b[1m${outdatedModules.length}\\x1b[0m module${\n      outdatedModules.length > 1 ? 's are' : ' is'\n    } outdated.`,\n  );\n  if (notFoundModules.length > 0) {\n    console.log('Could not find following modules:');\n    console.log(\n      '  ' + notFoundModules.map((result) => result.module.name).join(', '),\n    );\n  }\n  if (notFixedModules.length > 0) {\n    console.log('Version not fixed at following modules:');\n    console.log(\n      '  ' + notFixedModules.map((result) => result.module.name).join(', '),\n    );\n  }\n\n  if (outdatedModules.length > 0) {\n    const logTable: string[][] = [\n      ['', 'package', 'current', 'latest'],\n    ];\n    const outdatedTextMap = {\n      'major': '\\x1b[31mMajor\\x1b[0m',\n      'minor': '\\x1b[33mMinor\\x1b[0m',\n      'patch': '\\x1b[34mPatch\\x1b[0m',\n      'pre_release': '\\x1b[36mPre\\x1b[0m',\n      'none': 'Latest',\n      'not_found': 'Not Found',\n    };\n    for (const result of outdatedModules) {\n      logTable.push([\n        `${outdatedTextMap[result.outdatedLevel]}`,\n        result.module.name,\n        result.module.version ?? '(null)',\n        result.latestVersion,\n      ]);\n    }\n    const logTableStr = buildTableString(logTable, true);\n    console.log(logTableStr);\n  }\n};\n\nconst main = async function () {\n  const appVersionCheckResult = await checkModuleVersion({\n    type: 'raw_github',\n    name: appInfo.repository,\n    version: appInfo.version,\n  }, {\n    usePrerelease: false,\n    level: 'major',\n  });\n  if (appVersionCheckResult.found && appVersionCheckResult.outdated) {\n    console.log(`Update ${appVersionCheckResult.latestVersion} found`);\n    console.log('You can update with $\\x1b[33mdeno cache --reload\\x1b[0m');\n  }\n\n  const command = new cliffy.Command()\n    .name(appInfo.name)\n    .version(appInfo.version)\n    .description('Dependency scanner for Node.js and Deno project')\n    .option('-u --update [update:boolean]', 'update versions')\n    .option('--fix', 'fix version')\n    .option('-l, --level [level:string]', 'version update limit', {\n      default: 'major',\n    })\n    .option('--prerelease', 'use prerelease')\n    .arguments('[path]');\n\n  const { options, args } = await command.parse(Deno.args);\n  const level_ = (typeof options.level === 'string')\n    ? options.level.toLowerCase()\n    : options.level;\n  if (level_ !== 'major' && level_ !== 'minor' && level_ !== 'patch') {\n    console.error(`${level_} is not a valid level.`);\n    Deno.exit(1);\n  }\n  const level = level_ as 'major' | 'minor' | 'patch';\n  const usePrerelease = options.prerelease === true;\n  const doUpdate = options.update === true;\n  const doFix = options.fix === true;\n\n  const cwd = args.filter((v) => typeof v === 'string')[0] ?? Deno.cwd();\n  const fileGlobs: string[] = [];\n  for (const config of fileConfigs) {\n    if (config.enabled === undefined || config.enabled(cwd)) {\n      fileGlobs.push(config.file);\n    }\n  }\n\n  // gather modules from files\n  const fileConfigMap = new Map<string, FileConfig>();\n  const moduleMap = new Map<string, Module>();\n  for await (const [path, globName] of enumerateFiles(cwd, fileGlobs)) {\n    console.log(`Scanning ${path}...`);\n\n    for (const config of fileConfigs) {\n      if (config.file === globName) {\n        fileConfigMap.set(path, config);\n      }\n    }\n  }\n\n  for (const [path, config] of fileConfigMap.entries()) {\n    const content = await Deno.readTextFile(path);\n\n    config.resolver(content).forEach((module) => {\n      moduleMap.set(`${module.type}-${module.name}-${module.version}`, module);\n    });\n  }\n\n  const modules = [...moduleMap.values()];\n\n  // check updates\n  const results: ModuleVersionCheckResult[] = [];\n  for (const module of modules) {\n    const result = await checkModuleVersion(module, {\n      level,\n      usePrerelease,\n    });\n\n    if (!result.found) {\n      console.log(`\u2754${module.name} cannot be resolved (${module.type})`);\n    } else if (result.outdatedLevel === 'none') {\n      if (result.fixed) {\n        console.log(`\u2705 ${module.name} is up to date`);\n      } else {\n        console.log(`\u26A0\uFE0F ${module.name} may up to date (version not fixed)`);\n      }\n    } else {\n      if (result.fixed) {\n        console.log(`\u274C ${module.name} is outdated (${result.outdatedLevel})`);\n      } else {\n        console.log(\n          `\u274C ${module.name} is outdated (${result.outdatedLevel}) and version is not fixed`,\n        );\n      }\n    }\n\n    results.push(result);\n  }\n\n  // show result\n  console.log();\n  printVersionCheckResult(results);\n\n  // update\n  if (doUpdate) {\n    await updateVersion(results, doFix, fileConfigMap);\n  }\n};\n\nmain();\n", "import * as semver from 'semver';\nimport { Module } from './moduleTypes.ts';\nimport { getLatestVersions } from './moduleVersionResolver.ts';\n\ninterface ModuleVersionCheckOptions {\n  level: 'major' | 'minor' | 'patch';\n  usePrerelease: boolean;\n  gitHubToken?: string;\n}\n\ninterface ModuleVersionCheckResultFound {\n  module: Module;\n  fixed: boolean;\n  found: true;\n  outdated: boolean;\n  outdatedLevel: 'major' | 'minor' | 'patch' | 'pre_release' | 'none';\n  latestVersion: string;\n  latestVersionInRange: string;\n}\n\ninterface ModuleVersionCheckResultNotFound {\n  module: Module;\n  fixed: boolean;\n  found: false;\n}\n\ntype ModuleVersionCheckResult =\n  | ModuleVersionCheckResultFound\n  | ModuleVersionCheckResultNotFound;\n\nconst checkModuleVersion = async function (\n  module: Module,\n  options: ModuleVersionCheckOptions,\n): Promise<ModuleVersionCheckResult> {\n  const versionFixed = semver.parse(module.version ?? '') !== null;\n\n  const latestVersions = await getLatestVersions(\n    module.type,\n    module.name,\n    module.version ?? '',\n    options,\n  );\n  if (latestVersions === null) {\n    return {\n      module,\n      fixed: versionFixed,\n      found: false,\n    };\n  }\n\n  const latestVer = latestVersions.latest;\n  const latestVerInRange = latestVersions.latestInRange;\n\n  let outdatedLevel: ModuleVersionCheckResultFound['outdatedLevel'] = 'none';\n  if (semver.gt(latestVer, latestVerInRange, { includePrerelease: true })) {\n    if (latestVer.major > latestVerInRange.major) {\n      outdatedLevel = 'major';\n    } else if (latestVer.minor > latestVerInRange.minor) {\n      outdatedLevel = 'minor';\n    } else if (latestVer.patch > latestVerInRange.patch) {\n      outdatedLevel = 'patch';\n    } else {\n      outdatedLevel = 'pre_release';\n    }\n  }\n\n  // console.log(\n  //   name,\n  //   versionsInRange.map((v) => v.version),\n  //   versionsGreater.map((v) => v.version),\n  //   outdated,\n  // );\n\n  return {\n    module,\n    fixed: versionFixed,\n    found: true,\n    outdated: outdatedLevel !== 'none',\n    outdatedLevel,\n    latestVersion: latestVer.version,\n    latestVersionInRange: latestVerInRange.version,\n  };\n};\n\nexport type { ModuleVersionCheckOptions, ModuleVersionCheckResult };\n\nexport default checkModuleVersion;\n", "import * as semver from 'semver';\nimport { SemVer } from 'semver';\nimport moduleTypes from './moduleTypes.ts';\nimport { decomposePackageNameVersion } from './util.ts';\n\nconst getLargestVersion = (versions: SemVer[]) =>\n  versions.reduce((max, ver) => semver.gt(ver, max) ? ver : max);\n\nconst calcLatestVersionRange = function (\n  refVer: SemVer,\n  level: 'major' | 'minor' | 'patch',\n) {\n  let range = `>=${refVer}`;\n\n  if (level === 'major') {\n    // do nothing\n  } else if (level === 'minor') {\n    range += ` <=${refVer.major}`;\n  } else if (level === 'patch') {\n    range += ` <=${refVer.major}.${refVer.minor}`;\n  }\n\n  return range;\n};\n\nconst resolveNpmPackage = async function (pkgName: string) {\n  const url = `https://registry.npmjs.org/${pkgName}`;\n  const res = await fetch(url);\n  if (!res.ok) {\n    return null;\n  }\n  const data = JSON.parse(await res.text());\n  const versions = Object.keys(data['versions'])\n    .map((v) => semver.parse(v))\n    .filter((v) => v !== null) as SemVer[];\n\n  return versions;\n};\n\nconst resolveDenoLandPackage = async function (pkgName: string) {\n  const url = `https://apiland.deno.dev/v2/modules/${pkgName}`;\n  const res = await fetch(url);\n  if (!res.ok) {\n    return null;\n  }\n  const data = JSON.parse(await res.text());\n  const versions = (data['versions'] as string[])\n    .map((v) => semver.parse(v))\n    .filter((v) => v !== null) as SemVer[];\n\n  return versions;\n};\n\nconst resolveRawGitHubContent = async function (\n  repoName: string,\n  token?: string,\n) {\n  const headers = {\n    'Accept': 'application/vnd.github+json',\n    'X-GitHub-Api-Version': '2022-11-28',\n  };\n  if (typeof token === 'string') {\n    Object.defineProperty(headers, 'Authorization', {\n      value: `Bearer ${token}`,\n    });\n  }\n\n  const res = await fetch(\n    `https://api.github.com/repos/${repoName}/releases`,\n    { headers },\n  );\n  if (!res.ok) {\n    return null;\n  }\n  const data = JSON.parse(await res.text()) as Required<{ tag_name: string }>[];\n  const versions = (data)\n    .map((v) => semver.parse(v.tag_name))\n    .filter((v) => v !== null) as SemVer[];\n\n  return versions;\n};\n\nconst getEsmShVersion = async function (url: string) {\n  const moduleNameRegExp = /^\\/\\* esm.sh - (\\S+) \\*\\//;\n  const res = await fetch(url);\n  if (!res.ok) {\n    return null;\n  }\n\n  const content = await res.text();\n  const moduleNameMatch = content.match(moduleNameRegExp);\n  if (moduleNameMatch === null) {\n    return null;\n  }\n  const [_, version] = decomposePackageNameVersion(moduleNameMatch[1]);\n  return version;\n};\nconst resolveEsmSh = async function (pkgName: string, versionRange: string) {\n  const latestUrl = `https://esm.sh/${pkgName}`;\n  const latestInRangeUrl = `${latestUrl}@${versionRange}`;\n\n  const latest = semver.parse(await getEsmShVersion(latestUrl));\n  const latestInRange = semver.parse(await getEsmShVersion(latestInRangeUrl));\n  if (latest === null || latestInRange === null) {\n    return null;\n  }\n  return { latest, latestInRange };\n};\n\ninterface GetVersionsOptions {\n  level: 'major' | 'minor' | 'patch';\n  usePrerelease: boolean;\n  gitHubToken?: string;\n}\nconst versionListCache = new Map<string, SemVer[] | null>();\nconst getLatestVersions = async function (\n  type: typeof moduleTypes[keyof typeof moduleTypes],\n  name: string,\n  version: string,\n  options: GetVersionsOptions,\n) {\n  const semverOption = { includePrerelease: options.usePrerelease };\n  if (\n    type === moduleTypes.denoLand || type === moduleTypes.npmPackage ||\n    type === moduleTypes.rawGitHub\n  ) {\n    const cacheName = type + ':' + name;\n    const cachedVersionList = versionListCache.get(cacheName);\n\n    let versionList: SemVer[] | null = null;\n    if (typeof cachedVersionList !== 'undefined') {\n      versionList = cachedVersionList;\n    } else {\n      if (type === moduleTypes.denoLand) {\n        versionList = await resolveDenoLandPackage(name);\n      } else if (type === moduleTypes.npmPackage) {\n        versionList = await resolveNpmPackage(name);\n      } else if (type === moduleTypes.rawGitHub) {\n        versionList = await resolveRawGitHubContent(name, options.gitHubToken);\n      }\n\n      versionListCache.set(cacheName, versionList);\n    }\n\n    if (versionList === null || versionList.length < 1) {\n      return null;\n    }\n\n    const versionListInRange = versionList\n      .filter((ver) => semver.satisfies(ver, version, semverOption));\n    if (versionListInRange.length < 1) {\n      return null;\n    }\n    const latestInRange = getLargestVersion(versionListInRange);\n\n    const versionGreaterRange = calcLatestVersionRange(\n      latestInRange,\n      options.level,\n    );\n    const versionListGreater = versionList\n      .filter((ver) =>\n        semver.satisfies(ver, versionGreaterRange, semverOption)\n      );\n\n    return {\n      latest: getLargestVersion(versionListGreater),\n      latestInRange: latestInRange,\n    };\n  } else if (type === moduleTypes.esmSh) {\n    return resolveEsmSh(name, version);\n  }\n\n  return null;\n};\n\nexport { getLatestVersions };\n", "const moduleTypes = {\n  denoLand: 'deno_land',\n  npmPackage: 'npm_package',\n  rawGitHub: 'raw_github',\n  esmSh: 'esm_sh',\n  unknown: 'unknown',\n} as const;\n\nexport interface Module {\n  type: ModuleType;\n  name: string;\n  version: string | null;\n}\n\nexport type ModuleType = typeof moduleTypes[keyof typeof moduleTypes];\n\nexport default moduleTypes;\n", "/**\n * @example \"package@version\" -> [\"package\", \"version\"]\n * @example \"package\" -> [\"package\", \"\"]\n * @example \"@author/package@version\" -> [\"@author/package\", \"version\"]\n * @example \"@author/package\" -> [\"@author/package\"]\n */\nconst decomposePackageNameVersion = function (\n  pkgStr: string,\n): [string, string] {\n  const index = pkgStr.lastIndexOf('@');\n  if (index <= 0) {\n    return [pkgStr, ''];\n  } else {\n    return [pkgStr.slice(0, index), pkgStr.slice(index + 1)];\n  }\n};\n\nconst buildTableString = function (table: string[][], headSeparator = false) {\n  // deno-lint-ignore no-control-regex\n  const ansiEscRegExp = /\\x1b\\[\\d+(;\\d+)*m/g;\n  const rowNum = table.reduce(\n    (max, row) => max >= row.length ? max : row.length,\n    0,\n  );\n\n  const lengthMapTranspose: number[][] = new Array(rowNum).fill(0).map(() =>\n    new Array(table.length).fill(0)\n  );\n  const ansiEscLengthMap: number[][] = new Array(table.length).fill(0).map(() =>\n    new Array(rowNum).fill(0)\n  );\n  table.forEach((row, i) =>\n    row.forEach((cell, j) => {\n      const lenWithoutAnsiEsc = cell.replace(ansiEscRegExp, '').length;\n      lengthMapTranspose[j][i] = lenWithoutAnsiEsc;\n      ansiEscLengthMap[i][j] = cell.length - lenWithoutAnsiEsc;\n    })\n  );\n\n  const rowWidths = lengthMapTranspose.map((lengths) => {\n    return lengths.reduce((max, len) => max >= len ? max : len);\n  });\n  const paddedTable = table.map((row, i) =>\n    row.map((cell, j) => {\n      return (cell + (' '.repeat(rowWidths[j]))).slice(\n        0,\n        rowWidths[j] + ansiEscLengthMap[i][j],\n      );\n    })\n  );\n  if (headSeparator) {\n    paddedTable.splice(1, 0, rowWidths.map((width) => '-'.repeat(width)));\n  }\n\n  return paddedTable.map((row) => row.join(' ')).join('\\n');\n};\n\nexport { buildTableString, decomposePackageNameVersion };\n", "import * as fs from 'fs';\nimport * as posix from 'posix';\nimport { Module } from './moduleTypes.ts';\nimport * as moduleNameParser from './moduleNameParser.ts';\nimport * as fileResolver from './fileResolver.ts';\nimport * as moduleVersionReplacer from './moduleVersionReplacer.ts';\nimport * as fileVersionReplacer from './fileVersionReplacer.ts';\nimport { replacePackageJsonVersions } from './fileVersionReplacer.ts';\n\ninterface FileConfig {\n  file: string;\n  enabled?: (cwd: string) => boolean;\n  resolver: (content: string) => Module[];\n  replacer: (content: string, versions: [string, string][]) => string;\n}\n\nconst isDenoProjectCache = new Map<string, boolean>();\nconst isDenoProject = (cwd: string) => {\n  const cachedResult = isDenoProjectCache.get(cwd);\n  if (typeof cachedResult === 'boolean') {\n    return cachedResult;\n  }\n\n  if (fs.existsSync(posix.join(cwd, 'deno.json'), { isFile: true })) {\n    isDenoProjectCache.set(cwd, true);\n    return true;\n  }\n  if (fs.existsSync(posix.join(cwd, 'deno.jsonc'), { isFile: true })) {\n    isDenoProjectCache.set(cwd, true);\n    return true;\n  }\n\n  isDenoProjectCache.set(cwd, false);\n  return false;\n};\n\nconst denoModuleNameParsers = [\n  moduleNameParser.denoLandUrlParser,\n  moduleNameParser.rawGitHubUrlParser,\n  moduleNameParser.denoNpmModuleParser,\n  moduleNameParser.esmShModuleParser,\n];\n\nconst denoModuleVersionReplacers = [\n  moduleVersionReplacer.denoLandUrlReplacer,\n  moduleVersionReplacer.rawGitHubUrlReplacer,\n  moduleVersionReplacer.denoNpmModuleReplacer,\n  moduleVersionReplacer.esmShModuleReplacer,\n];\n\nconst npmPackageJson: FileConfig = {\n  file: 'package.json',\n  resolver: (content) => {\n    return fileResolver.resolvePackageJson(content);\n  },\n  replacer: (content, versions) => {\n    return replacePackageJsonVersions(content, versions);\n  },\n};\n\nconst denoImportMap: FileConfig = {\n  file: 'import_map.json',\n  enabled: isDenoProject,\n  resolver: (content) => {\n    return fileResolver.resolveImportMap(content, denoModuleNameParsers);\n  },\n  replacer: (content, versions) => {\n    return fileVersionReplacer.replaceImportMapVersions(\n      content,\n      versions,\n      denoModuleVersionReplacers,\n    );\n  },\n};\n\nconst denoDepsTs: FileConfig = {\n  file: 'deps.ts',\n  enabled: isDenoProject,\n  resolver: (content) => {\n    return fileResolver.resolveDenoModuleNameStrings(\n      content,\n      denoModuleNameParsers,\n    );\n  },\n  replacer: (content, versions) => {\n    return fileVersionReplacer.replaceDenoModuleNameStringVersions(\n      content,\n      versions,\n      denoModuleVersionReplacers,\n    );\n  },\n};\n\nconst denoDepsJs: FileConfig = {\n  file: '**/deps.js',\n  enabled: isDenoProject,\n  resolver: (content) => {\n    return fileResolver.resolveDenoModuleNameStrings(\n      content,\n      denoModuleNameParsers,\n    );\n  },\n  replacer: (content, versions) => {\n    return fileVersionReplacer.replaceDenoModuleNameStringVersions(\n      content,\n      versions,\n      denoModuleVersionReplacers,\n    );\n  },\n};\n\nconst configurations = [\n  npmPackageJson,\n  denoImportMap,\n  denoDepsTs,\n  denoDepsJs,\n];\n\nexport type { FileConfig };\n\nexport { configurations };\n", "import { decomposePackageNameVersion } from './util.ts';\nimport { default as moduleTypes, Module } from './moduleTypes.ts';\n\ninterface ModuleNameParser {\n  test: RegExp;\n  parse: (moduleName: string) => Module;\n}\n\nconst denoLandUrlParser: ModuleNameParser = {\n  test: /^https?:\\/\\/deno.land/,\n  parse: (moduleName) => {\n    const path = new URL(moduleName).pathname.split('/').slice(1);\n    const pkgStr = path[0] === 'x' ? path[1] : path[0];\n    const [name, version] = decomposePackageNameVersion(pkgStr);\n\n    return {\n      type: moduleTypes.denoLand,\n      name,\n      version,\n    };\n  },\n};\n\nconst rawGitHubUrlParser: ModuleNameParser = {\n  test: /^https?:\\/\\/raw.githubusercontent.com/,\n  parse: (moduleName) => {\n    const path = new URL(moduleName).pathname.split('/').slice(1);\n    const name = `${path[0]}/${path[1]}`;\n    const version = path[2];\n\n    return {\n      type: moduleTypes.rawGitHub,\n      name,\n      version,\n    };\n  },\n};\n\nconst denoNpmModuleParser: ModuleNameParser = {\n  test: /^npm:/,\n  parse: (moduleName) => {\n    const [name, version] = decomposePackageNameVersion(moduleName.slice(4));\n    return {\n      type: moduleTypes.npmPackage,\n      name,\n      version,\n    };\n  },\n};\n\nconst esmShModuleParser: ModuleNameParser = {\n  test: /^https?:\\/\\/esm.sh/,\n  parse: (moduleName) => {\n    const path = new URL(moduleName).pathname.split('/').slice(1);\n    const [name, version] = decomposePackageNameVersion(path[0]);\n\n    return {\n      type: moduleTypes.esmSh,\n      name,\n      version,\n    };\n  },\n};\n\nconst parseModuleName = function (\n  url: string,\n  parsers: ModuleNameParser[],\n): ReturnType<ModuleNameParser['parse']> | null {\n  for (const parser of parsers) {\n    if (parser.test.test(url)) {\n      return parser.parse(url);\n    }\n  }\n\n  return null;\n};\n\nexport type { ModuleNameParser };\n\nexport {\n  denoLandUrlParser,\n  denoNpmModuleParser,\n  esmShModuleParser,\n  parseModuleName,\n  rawGitHubUrlParser,\n};\n", "import { ModuleNameParser, parseModuleName } from './moduleNameParser.ts';\nimport { default as moduleTypes, Module } from './moduleTypes.ts';\nimport { Importmap, PackageJson } from './fileTypes.ts';\n\nconst resolvePackageJson = function (content: string): Module[] {\n  const packageJson = JSON.parse(content) as PackageJson;\n\n  // TODO: support imports other than npm\n  const results: Module[] = [];\n  for (const name in packageJson.dependencies) {\n    results.push({\n      type: moduleTypes.npmPackage,\n      name,\n      version: packageJson.dependencies[name],\n    });\n  }\n  for (const name in packageJson.devDependencies) {\n    results.push({\n      type: moduleTypes.npmPackage,\n      name,\n      version: packageJson.devDependencies[name],\n    });\n  }\n\n  return results;\n};\n\nconst parseModuleNameWrapper = function (\n  moduleName: string,\n  parsers: ModuleNameParser[],\n): Module {\n  return parseModuleName(moduleName, parsers) ?? {\n    type: moduleTypes.unknown,\n    name: moduleName,\n    version: null,\n  };\n};\n\nconst resolveImportMap = function (\n  content: string,\n  parsers: ModuleNameParser[],\n): Module[] {\n  const importmap = JSON.parse(content) as Importmap;\n\n  const moduleNames = [\n    ...Object.values(importmap?.imports ?? {}),\n    ...Object.values(importmap?.scopes ?? {})\n      .flatMap((map) => Object.values(map)),\n  ];\n\n  return moduleNames.map((moduleName) =>\n    parseModuleNameWrapper(moduleName, parsers)\n  );\n};\n\nconst resolveDenoModuleNameStrings = function (\n  content: string,\n  parsers: ModuleNameParser[],\n): Module[] {\n  const regExps = [\n    /\"https?:\\/\\/[\\w/:%#\\$&\\?\\(\\)~\\.=\\+\\-@]+\"/g,\n    /'https?:\\/\\/[\\w/:%#\\$&\\?\\(\\)~\\.=\\+\\-@]+'/g,\n    /`https?:\\/\\/[\\w/:%#\\$&\\?\\(\\)~\\.=\\+\\-@]+`/g,\n    /\"npm:[\\w/:%#\\$&\\?\\(\\)~\\.=\\+\\-@]+\"/g,\n    /'npm:[\\w/:%#\\$&\\?\\(\\)~\\.=\\+\\-@]+'/g,\n    /`npm:[\\w/:%#\\$&\\?\\(\\)~\\.=\\+\\-@]+`/g,\n  ];\n\n  const moduleNames = regExps.flatMap((regExp) => [...content.matchAll(regExp)])\n    .map((match) => match[0].slice(1, -1));\n\n  return moduleNames.map((moduleName) =>\n    parseModuleNameWrapper(moduleName, parsers)\n  );\n};\n\nexport { resolveDenoModuleNameStrings, resolveImportMap, resolvePackageJson };\n", "import { SemVer } from 'semver';\nimport { decomposePackageNameVersion } from './util.ts';\n\nconst isIntegerString = (str: unknown) =>\n  typeof str === 'string' && isFinite(parseInt(str));\n\nconst updateVersionRange = function (range: string, version: SemVer) {\n  const rangeRegExp =\n    /^([v=\\^~])?(\\d+|[xX*])(?:\\.(\\d+|[xX*])(?:\\.(\\d+|[xX*])(.+)?)?)?$/;\n\n  const match = range.match(rangeRegExp);\n  if (match === null) {\n    return null;\n  }\n\n  const prefix = match[1];\n  let major = match[2];\n  let minor = match[3];\n  let patch = match[4];\n  let prerelease = match[5];\n\n  if (isIntegerString(major)) {\n    major = `${version.major}`;\n  }\n  if (isIntegerString(minor)) {\n    minor = `${version.minor}`;\n  }\n  if (isIntegerString(patch)) {\n    patch = `${version.patch}`;\n  }\n  if (version.prerelease.length === 0) {\n    prerelease = '';\n  } else {\n    prerelease = ((prerelease ?? '-')[0]) + version.prerelease.join('.');\n  }\n\n  let newRange = `${prefix ?? ''}${major}`;\n  if (minor) {\n    newRange += `.${minor}`;\n  }\n  if (patch) {\n    newRange += `.${patch}`;\n  }\n  if (prerelease) {\n    newRange += prerelease;\n  }\n\n  return newRange;\n};\n\ninterface ModuleVersionReplacer {\n  test: RegExp;\n  replace: (\n    moduleName: string,\n    nameTest: string,\n    version: string,\n  ) => string | null;\n}\n\nconst denoLandUrlReplacer: ModuleVersionReplacer = {\n  test: /^https?:\\/\\/deno.land/,\n  replace: (moduleName, nameTest, version) => {\n    const url = new URL(moduleName);\n    const path = url.pathname.split('/').slice(1);\n    const pkgStr = path[0] === 'x' ? path[1] : path[0];\n    const [name, _] = decomposePackageNameVersion(pkgStr);\n\n    if (name !== nameTest) {\n      return null;\n    }\n\n    path[path[0] === 'x' ? 1 : 0] = `${name}@${version}`;\n\n    return `https://deno.land/${path.join('/')}${url.search}`;\n  },\n};\n\nconst rawGitHubUrlReplacer: ModuleVersionReplacer = {\n  test: /^https?:\\/\\/raw.githubusercontent.com/,\n  replace: (moduleName, nameTest, version) => {\n    const url = new URL(moduleName);\n    const path = url.pathname.split('/').slice(1);\n    const name = `${path[0]}/${path[1]}`;\n\n    if (name !== nameTest) {\n      return null;\n    }\n\n    path[2] = version;\n\n    return `https://raw.githubusercontent.com/${path.join('/')}${url.search}`;\n  },\n};\n\nconst denoNpmModuleReplacer: ModuleVersionReplacer = {\n  test: /^npm:/,\n  replace: (moduleName, nameTest, version) => {\n    const [name, _] = decomposePackageNameVersion(moduleName.slice(4));\n\n    if (name !== nameTest) {\n      return null;\n    }\n\n    return `npm:${name}@${version}`;\n  },\n};\n\nconst esmShModuleReplacer: ModuleVersionReplacer = {\n  test: /^https?:\\/\\/esm.sh/,\n  replace: (moduleName, nameTest, version) => {\n    const url = new URL(moduleName);\n    const path = url.pathname.split('/').slice(1);\n    const [name, _] = decomposePackageNameVersion(path[0]);\n\n    if (name !== nameTest) {\n      return null;\n    }\n\n    return `https://esm.sh/${name}@${version}${url.search}`;\n  },\n};\n\nconst replaceModuleVersion = function (\n  moduleName: string,\n  nameTest: string,\n  replacers: ModuleVersionReplacer[],\n  version: string,\n): ReturnType<ModuleVersionReplacer['replace']> | null {\n  for (const replacer of replacers) {\n    if (replacer.test.test(moduleName)) {\n      const replaced = replacer.replace(moduleName, nameTest, version);\n\n      if (replaced !== null) {\n        return replaced;\n      }\n    }\n  }\n\n  return null;\n};\n\nexport type { ModuleVersionReplacer };\n\nexport {\n  denoLandUrlReplacer,\n  denoNpmModuleReplacer,\n  esmShModuleReplacer,\n  rawGitHubUrlReplacer,\n  replaceModuleVersion,\n  updateVersionRange,\n};\n", "import {\n  ModuleVersionReplacer,\n  replaceModuleVersion,\n} from './moduleVersionReplacer.ts';\nimport { JSONParser, replaceJSONValue } from 'json-edit';\nimport { Importmap } from './fileTypes.ts';\n\nconst replacePackageJsonVersions = function (\n  content: string,\n  versions: [string, string][],\n) {\n  const packageJson = JSONParser.parse(content);\n\n  for (const [name, version] of versions) {\n    try {\n      replaceJSONValue(\n        packageJson,\n        ['dependencies', name],\n        JSON.stringify(version),\n      );\n      continue;\n    } catch {\n      // just erase error\n    }\n\n    try {\n      replaceJSONValue(\n        packageJson,\n        ['devDependencies', name],\n        JSON.stringify(version),\n      );\n      continue;\n    } catch {\n      // just erase error\n    }\n\n    console.error(`Failed to update ${name}`);\n  }\n\n  return packageJson.stringify();\n};\n\nconst replaceImportMapVersions = function (\n  content: string,\n  versions: [string, string][],\n  replacers: ModuleVersionReplacer[],\n) {\n  const importmap = JSON.parse(content) as Importmap;\n  const importmapTree = JSONParser.parse(content);\n\n  for (const key in importmap.imports) {\n    for (const [name, version] of versions) {\n      const replaced = replaceModuleVersion(\n        importmap.imports[key],\n        name,\n        replacers,\n        version,\n      );\n      if (typeof replaced === 'string') {\n        try {\n          replaceJSONValue(\n            importmapTree,\n            ['imports', key],\n            JSON.stringify(replaced),\n          );\n          break;\n        } catch {\n          console.error(`Failed to update ${name}`);\n        }\n      }\n    }\n  }\n\n  for (const scopeKey in importmap.scopes) {\n    for (const key in importmap.scopes[scopeKey]) {\n      for (const [name, version] of versions) {\n        const replaced = replaceModuleVersion(\n          importmap.scopes[scopeKey][key],\n          name,\n          replacers,\n          version,\n        );\n        if (typeof replaced === 'string') {\n          try {\n            replaceJSONValue(\n              importmapTree,\n              ['scopes', scopeKey, key],\n              JSON.stringify(replaced),\n            );\n            break;\n          } catch {\n            console.error(`Failed to update ${name}`);\n          }\n          break;\n        }\n      }\n    }\n  }\n\n  return importmapTree.stringify();\n};\n\nconst replaceDenoModuleNameStringVersions = function (\n  content_: string,\n  versions: [string, string][],\n  replacers: ModuleVersionReplacer[],\n) {\n  const regExps = [\n    /(\"https?:\\/\\/[\\w/:%#\\$&\\?\\(\\)~\\.=\\+\\-@]+\")/g,\n    /('https?:\\/\\/[\\w/:%#\\$&\\?\\(\\)~\\.=\\+\\-@]+')/g,\n    /(`https?:\\/\\/[\\w/:%#\\$&\\?\\(\\)~\\.=\\+\\-@]+`)/g,\n    /(\"npm:[\\w/:%#\\$&\\?\\(\\)~\\.=\\+\\-@]+\")/g,\n    /('npm:[\\w/:%#\\$&\\?\\(\\)~\\.=\\+\\-@]+')/g,\n    /(`npm:[\\w/:%#\\$&\\?\\(\\)~\\.=\\+\\-@]+`)/g,\n  ];\n\n  let content = content_;\n  for (const regExp of regExps) {\n    content = content.replaceAll(regExp, (moduleName) => {\n      for (const [name, version] of versions) {\n        const replaced = replaceModuleVersion(\n          moduleName,\n          name,\n          replacers,\n          version,\n        );\n        if (typeof replaced === 'string') {\n          return replaced;\n        }\n      }\n      return moduleName;\n    });\n  }\n\n  return content;\n};\n\nexport {\n  replaceDenoModuleNameStringVersions,\n  replaceImportMapVersions,\n  replacePackageJsonVersions,\n};\n", "{\n  \"name\": \"Delichon\",\n  \"repository\": \"Tsukina-7mochi/delichon\",\n  \"version\": \"0.3.1\"\n}", "import * as semver from 'semver';\nimport { FileConfig } from './files.ts';\nimport { ModuleVersionCheckResult } from './moduleVersionChecker.ts';\nimport { updateVersionRange } from './moduleVersionReplacer.ts';\n\nconst updateVersion = async function (\n  results: ModuleVersionCheckResult[],\n  doFix: boolean,\n  fileConfigMap: Map<string, FileConfig>,\n) {\n  const versions: [string, string][] = [];\n\n  for (const result of results) {\n    if (!result.found) continue;\n    if (!result.outdated) continue;\n    if (typeof result.module.version !== 'string') continue;\n\n    const latestVersion = semver.parse(result.latestVersion);\n    if (latestVersion === null) continue;\n\n    const targetVersion = doFix\n      ? result.latestVersion\n      : updateVersionRange(result.module.version, latestVersion);\n\n    if (targetVersion === null) continue;\n\n    versions.push([result.module.name, targetVersion]);\n  }\n\n  console.log(versions);\n\n  for (const [path, config] of fileConfigMap.entries()) {\n    console.log(`Updating ${path}`);\n\n    let content = await Deno.readTextFile(path);\n\n    content = config.replacer(content, versions);\n\n    await Deno.writeTextFileSync(path, content);\n  }\n};\n\nexport default updateVersion;\n"],
  "mappings": "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",
  "names": ["fs", "posix", "cliffy", "semver", "semver", "moduleTypes", "moduleTypes_default", "decomposePackageNameVersion", "pkgStr", "index", "buildTableString", "table", "headSeparator", "ansiEscRegExp", "rowNum", "max", "row", "lengthMapTranspose", "ansiEscLengthMap", "i", "cell", "j", "lenWithoutAnsiEsc", "rowWidths", "lengths", "len", "paddedTable", "width", "getLargestVersion", "versions", "max", "ver", "calcLatestVersionRange", "refVer", "level", "range", "resolveNpmPackage", "pkgName", "url", "res", "data", "v", "resolveDenoLandPackage", "resolveRawGitHubContent", "repoName", "token", "headers", "getEsmShVersion", "moduleNameRegExp", "moduleNameMatch", "_", "version", "decomposePackageNameVersion", "resolveEsmSh", "versionRange", "latestUrl", "latestInRangeUrl", "latest", "latestInRange", "versionListCache", "getLatestVersions", "type", "name", "options", "semverOption", "moduleTypes_default", "cacheName", "cachedVersionList", "versionList", "versionListInRange", "versionGreaterRange", "versionListGreater", "checkModuleVersion", "module", "options", "versionFixed", "latestVersions", "getLatestVersions", "latestVer", "latestVerInRange", "outdatedLevel", "moduleVersionChecker_default", "fs", "posix", "denoLandUrlParser", "moduleName", "path", "pkgStr", "name", "version", "decomposePackageNameVersion", "moduleTypes_default", "rawGitHubUrlParser", "denoNpmModuleParser", "esmShModuleParser", "parseModuleName", "url", "parsers", "parser", "resolvePackageJson", "content", "packageJson", "results", "name", "moduleTypes_default", "parseModuleNameWrapper", "moduleName", "parsers", "parseModuleName", "resolveImportMap", "importmap", "map", "resolveDenoModuleNameStrings", "regExp", "match", "isIntegerString", "str", "updateVersionRange", "range", "version", "rangeRegExp", "match", "prefix", "major", "minor", "patch", "prerelease", "newRange", "denoLandUrlReplacer", "moduleName", "nameTest", "url", "path", "pkgStr", "name", "_", "decomposePackageNameVersion", "rawGitHubUrlReplacer", "denoNpmModuleReplacer", "esmShModuleReplacer", "replaceModuleVersion", "replacers", "replacer", "replaced", "JSONParser", "replaceJSONValue", "replacePackageJsonVersions", "content", "versions", "packageJson", "name", "version", "replaceImportMapVersions", "replacers", "importmap", "importmapTree", "key", "replaced", "replaceModuleVersion", "scopeKey", "replaceDenoModuleNameStringVersions", "content_", "regExps", "regExp", "moduleName", "isDenoProjectCache", "isDenoProject", "cwd", "cachedResult", "denoModuleNameParsers", "denoLandUrlParser", "rawGitHubUrlParser", "denoNpmModuleParser", "esmShModuleParser", "denoModuleVersionReplacers", "denoLandUrlReplacer", "rawGitHubUrlReplacer", "denoNpmModuleReplacer", "esmShModuleReplacer", "npmPackageJson", "content", "resolvePackageJson", "versions", "replacePackageJsonVersions", "denoImportMap", "resolveImportMap", "replaceImportMapVersions", "denoDepsTs", "resolveDenoModuleNameStrings", "replaceDenoModuleNameStringVersions", "denoDepsJs", "configurations", "app_default", "semver", "updateVersion", "results", "doFix", "fileConfigMap", "versions", "result", "latestVersion", "targetVersion", "updateVersionRange", "path", "config", "content", "moduleVersionUpdater_default", "enumerateFiles", "basePath", "files", "filename", "file", "printVersionCheckResult", "results", "isFound", "item", "isNotFound", "outdatedModules", "result", "notFoundModules", "notFixedModules", "logTable", "outdatedTextMap", "logTableStr", "buildTableString", "main", "appVersionCheckResult", "moduleVersionChecker_default", "app_default", "command", "options", "args", "level_", "level", "usePrerelease", "doUpdate", "doFix", "cwd", "v", "fileGlobs", "config", "configurations", "fileConfigMap", "moduleMap", "path", "globName", "content", "module", "modules", "moduleVersionUpdater_default"]
}
